<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>balončeki 0.003</title>
    <script type="text/javascript" src="Scripts/phaser.js"></script>
    <script type="text/javascript" src="Scripts/jquery-3.1.1.js"></script>

    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

    <script type="text/javascript">
        var gWidth = window.innerWidth; // 800;
        var gHeight = window.innerHeight; // 600 ;

        var game = new Phaser.Game(gWidth, gHeight, Phaser.AUTO, '', { preload: preload, create: create, update: update });

        function preload() {
            game.load.image('background', 'babalon/background2.jpg');
            game.load.image('balon1', 'babalon/balloon_blue.png');
            game.load.image('balon2', 'babalon/balloon_green.png');
            game.load.image('balon3', 'babalon/balloon_red.png');
            game.load.image('balon4', 'babalon/balloon_gold.png');
            game.load.image('balon5', 'babalon/balloon_yellow.png');
            game.load.image('balon6', 'babalon/balloon_white.png');
            game.load.physics('physicsData', 'booble/physicsData.json');
            
        }

        var player;        
        var cursors;
        var balonNum = 10 /*218*/, balon, baloni;
        var baloniListaPopust = new Array();
        var baloniPopust = new Array();
        var life = 3;
        var maxScore = 0;
        var moveTime = 9000;
        

        function create() {
            game.scale.setMaximum();
            resizeGame();
            //game.physics.startSystem(Phaser.Physics.ARCADE);
            game.physics.startSystem(Phaser.Physics.P2JS);

            bck = game.add.sprite(0, 0, 'background');
            bck.width = gWidth;
            bck.height = gHeight;
            //bck.body.enableBody = true;

            baloni = game.add.group();            
            baloni.enableBody = true;
            baloni.physicsBodyType = Phaser.Physics.P2JS;            

            game.physics.arcade.enable(baloni);
            createBaloni();
            balloonSet();
            moveBalone();

            game.input.onTap.add(moveBalone, this);
        }

        function createBaloni() {
            for (i = 0; i < balonNum; i++) {
                var x = Math.random() * gWidth;
                var y = Math.random() * gHeight;
                var tip = Math.round( Math.random() * 6 );
                if (tip == 0) tip = 1;
                if (tip == 1)
                    balon = game.add.sprite(x, y, 'balon1');
                else if (tip == 2)
                    balon = game.add.sprite(x, y, 'balon2');
                else if (tip == 3)
                    balon = game.add.sprite(x, y, 'balon3');
                else if (tip == 4)
                    balon = game.add.sprite(x, y, 'balon4');
                else if (tip == 5)
                    balon = game.add.sprite(x, y, 'balon5');
                else if (tip == 6)
                    balon = game.add.sprite(x, y, 'balon6');
                
                //balon.body.enableBody = true;
                balon.scale.setTo(0.2, 0.2);
                balon.physicsType = Phaser.Physics.P2JS;                
                baloni.add(balon);
            }
        }

        function balloonSet() {
            for (i = 0; i < baloni.children.length; i++) {
                baloni.children[i].body.clearShapes();
                baloni.children[i].body.loadPolygon('physicsData', 'balloon')
                //baloni.children[i].body.setZeroVelocity();
                //baloni.children[i].body.static = true;
            }
        }

        function update() {
            // some code
            //game.time.events.loop(moveTime + 2000, moveBalone);
        }

        function moveBalone() {            
            for (i = 0; i < baloni.children.length - 1; i++) {
                //baloni.children[i].body.enable = true;
                game.add.tween(baloni.children[i]).to({ x: this.game.world.randomX, y: this.game.world.randomY }, moveTime, Phaser.Easing.Quadratic.InOut, true);
            }            
        }


        var resizeGame = this._fitScreen = function () {
            game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
            game.scale.pageAlignHorizontally = true;
            game.scale.pageAlignVertically = true;
            game.scale.forceOrientation(true, true);
            game.scale.setShowAll();
            game.scale.refresh();
        }


    </script>

</body>
</html>