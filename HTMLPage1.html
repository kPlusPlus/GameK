<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <script>
        var adminManager = new ActiveXObject('Microsoft.ApplicationHost.WritableAdminManager');
        adminManager.CommitPath = "MACHINE/WEBROOT/APPHOST";

        var webSocketSection = adminManager.GetAdminSection("system.webServer/webSocket", "MACHINE/WEBROOT/APPHOST/Default Web Site");
        webSocketSection.Properties.Item("enabled").Value = true;
        webSocketSection.Properties.Item("receiveBufferLimit").Value = 4194304;
        webSocketSection.Properties.Item("pingInterval").Value = "00:00:10";

        adminManager.CommitChanges();
        adminManager.mess("eee");

        function sendwe(mess) {

            WebSocket.OPEN();
        }
    </script>
    <input type="button" onclick="sendwe('ave maria')" value="test" />
</body>
</html>