<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>balončeki 0.001</title>
    <script type="text/javascript" src="Scripts/phaser.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

    <script type="text/javascript">
        var gWidth = window.innerWidth; // 800;
        var gHeight = window.innerHeight; // 600 ;

        var game = new Phaser.Game(gWidth, gHeight, Phaser.AUTO, '', { preload: preload, create: create, update: update });

        function preload() {

            game.load.image('balon1', 'balon/balloon_blue.png');
            game.load.image('balon2', 'balon/balloon_green.png');
            game.load.image('balon3', 'balon/balloon_red.png');
            game.load.image("totem", "balon/totem.png");
            game.load.image("pumpbase", "balon/pumpbase.png");
            game.load.image("pumpup", "balon/pump_up.png");
            game.load.spritesheet("button", "balon/button.png", 176, 79);
        }

        var player;
        var platforms;
        var cursors;
        var pumpa, balon, balonPerc = 0.01, balonWidth, balonHeight;
        var pumpaSmjer = 0; pumpaStep = 0;
        var score = 0;
        var power = 0;
        var scoreText, powerText;
        var timer = 0;
        var button;

        function create() {
            game.scale.setMaximum();
            resizeGame();

            game.physics.startSystem(Phaser.Physics.ARCADE);

            //  A simple background for our game
            game.add.sprite(0, 0, 'totem');
            player = game.add.sprite(gWidth / 2 - 2, 200, "pumpup");
            pumpa = game.add.sprite(gWidth / 2, gHeight / 2, "pumpbase");            
            balon = game.add.sprite(gWidth / 2 - 100, 0, "balon1");
            //balon.anchor.setTo(0.5, 0.5);
            balonWidth = balon.width;
            balonHeight = balon.height;
            balon.x = gWidth / 2 + 10;
            balon.y = gHeight - pumpa.height - 15;
            balon.width = balonWidth * balonPerc;
            balon.height = balonHeight * balonPerc;
            scoreText = game.add.text(16, 16, 'score: 0', { fontSize: '32px', fill: '#0CAAFF' });
            powerText = game.add.text(50, 180, "snaga: " + power);
            //  Our controls.
            cursors = game.input.keyboard.createCursorKeys();

        }

        function update() {
            timer = timer + 1;
            
            if (timer == 5) {
                power = power - 0.2;
                if (cursors.left.isDown){
                    power = power + 1;
                    pumpaj();
                }

                if (cursors.right.isDown){
                    power = power + 1;
                    pumpaj();
                }
                timer = 0;
                ShowPower();
                ShowBalon();
            }
        }

        function ShowBalon() {
            balonPerc = balonPerc + (power / 1000);
            balon.width = balonWidth * balonPerc;
            balon.height = balonHeight * balonPerc;
        }

        function pumpaj() {
            if (pumpaSmjer == 0) {
                pumpaStep = pumpaStep + 1;
                if (pumpaStep == 100) pumpaSmjer = 1;
                player.y = player.y + 1;
            }
            if (pumpaSmjer == 1){
                pumpaStep = pumpaStep - 1;
                if (pumpaStep == 0) pumpaSmjer = 0;
                player.y = player.y - 1;
            }
            
        }

        function ShowPower() {
            powerText.text = "snaga: " + power + "\n balon " + balonPerc;
        }

        var resizeGame = this._fitScreen = function () {
            game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
            game.scale.pageAlignHorizontally = true;
            game.scale.pageAlignVertically = true;
            game.scale.forceOrientation(true, true);
            game.scale.setShowAll();
            game.scale.refresh();
        }

    </script>

</body>
</html>